install.packages("rpart")
x <- 2
install.packages("plyr", dependencies = TRUE)
install.packages(c("colorspace", "curl", "DBI", "digest", "evaluate", "git2r", "gtable", "httr", "jsonlite", "memoise", "mime", "munsell", "proto", "R6", "Rcpp", "RCurl", "RSQLite", "rstudioapi", "stringi", "stringr", "yaml"))
install.packages("curl")
file.edit('~/.Renviron')
install.packages("curl")
install.packages("ggplot2", lib = "/home/shashwat/R/R Packages/")
install.packages("Rcpp", lib = "/home/shashwat/R/R Packages/")
install.packages("Rcpp", lib = "/home/shashwat/R/R Packages/")
install.packages("ggplot2", lib = "/home/shashwat/R/R Packages/")
install.packages("Rcpp")
install.packages("caTools",lib = "/home/shashwat/R/R Packages/")
library(rpart)
library(rpart.plot)
library(ROCR)
library(randomForest)
library(caret)
install.packages("caret",lib = "/home/shashwat/R/R Packages/")
library(caret)
library(caret, lib = "/home/shashwat/R/R Packages/")
install.packages("ggplot2",lib = "/home/shashwat/R/R Packages/")
library(caret, lib = "/home/shashwat/R/R Packages/")
library(e1071)
library(caret)
library(caret)
library(caret)
library(caret)
library(e1071)
Claims = read.csv("ClaimsData.csv")
setwd('Analytics Edge Course/4 Trees/2 D2Hawkeye/')
Claims = read.csv("ClaimsData.csv")
setwd(str(Claims)
table(Claims$bucket2009)/nrow(Claims)
table(Claims$bucket2009)/nrow(Claims)
library(caTools)
set.seed(88)
spl = sample.split(Claims$bucket2009, SplitRatio = 0.6)
ClaimsTrain = subset(Claims, spl==TRUE)
ClaimsTest = subset(Claims, spl==FALSE)
table(ClaimsTest$bucket2009, ClaimsTest$bucket2008)
str(ClaimsTrain)
mena(ClaimsTrain$age)
mean(ClaimsTrain$age)
mean(ClaimsTrain$diabetes)
table(ClaimsTest$bucket2009, ClaimsTest$bucket2008)
(110138 + 10721 + 2774 + 1539 + 104)/nrow(ClaimsTest)
PenaltyMatrix = matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0), byrow=TRUE, nrow=5)
PenaltyMatrix
as.matrix(table(ClaimsTest$bucket2009, ClaimsTest$bucket2008))*PenaltyMatrix
sum(as.matrix(table(ClaimsTest$bucket2009, ClaimsTest$bucket2008))*PenaltyMatrix)/nrow(ClaimsTest)
library(rpart)
library(rpart.plot)
110138/nrow(ClaimsTest)
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method="class", cp=0.00005)
prp(ClaimsTree)
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = "class")
table(ClaimsTest$bucket2009, PredictTest)
(114141 + 16102 + 118 + 201 + 0)/nrow(ClaimsTest)
as.matrix(table(ClaimsTest$bucket2009, PredictTest))*PenaltyMatrix
sum(as.matrix(table(ClaimsTest$bucket2009, PredictTest))*PenaltyMatrix)/nrow(ClaimsTest)
sum(as.matrix(table(ClaimsTest$bucket2009, ClaimsTest$bucket2008))*PenaltyMatrix)/nrow(ClaimsTest) # Penalty for the baseline method
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method="class", cp=0.00005, parms=list(loss=PenaltyMatrix))
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = "class")
table(ClaimsTest$bucket2009, PredictTest)
(94310 + 18942 + 4692 + 636 + 2)/nrow(ClaimsTest)
sum(as.matrix(table(ClaimsTest$bucket2009, PredictTest))*PenaltyMatrix)/nrow(ClaimsTest)
prp(ClaimsTree)
PenaltyMatrix = matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0), byrow=TRUE, nrow=5)
PenaltyMatrix
